
FROM unoplatform/wasm-build:5.0 AS build
WORKDIR /src
ENV MonoWasmSDKUri "DCSSTV/DCSSTV.Wasm/dotnet-runtime-wasm-c3c48f8-23980-Release.zip"
COPY ["DCSSTV/DCSSTV.Wasm/dotnet-runtime-wasm-c3c48f8-23980-Release.zip", "./DCSSTV/DCSSTV.Wasm/"]
COPY ["DCSSTV/DCSSTV.Wasm/wasm-binaries.tbz2", "./DCSSTV/DCSSTV.Wasm/"]
COPY ["DCSSTV/DCSSTV.Wasm/node-v12.18.1-linux-x64.tar.xz", "./DCSSTV/DCSSTV.Wasm/"]
ENV MonoWasmSDKUri=/src/DCSSTV/DCSSTV.Wasm/dotnet-runtime-wasm-c3c48f8-23980-Release.zip

#RUN /bin/bash -c 'mkdir -p /root/.uno/emsdk/emsdk-2.0.11/emsdk/upstream'
#RUN /bin/bash -c 'tar -jxvf DCSSTV/DCSSTV.Wasm/wasm-binaries.tbz2 -C /root/.uno/emsdk/emsdk-2.0.11/emsdk/upstream'
#RUN /bin/bash -c 'mkdir -p /root/.uno/emsdk/emsdk-2.0.11/emsdk/node/12.18.1_64bit'
#RUN /bin/bash -c 'tar -xf DCSSTV/DCSSTV.Wasm/node-v12.18.1-linux-x64.tar.xz -C /root/.uno/emsdk/emsdk-2.0.11/emsdk/node/12.18.1_64bit'
#RUN /bin/bash -c 'npm ci ...'
#RUN /bin/bash -c 'npm install google-closure-compiler-linux'

WORKDIR /src
COPY ["DCSSTV/DCSSTV.Wasm/DCSSTV.Wasm.csproj", "./DCSSTV/DCSSTV.Wasm/"]
COPY ["TtyRecDecoder/TtyRecDecoder.csproj", "./TtyRecDecoder/"]
COPY ["PuttySharp/PuttySharp.csproj", "./PuttySharp/"]
COPY ["InputParse/InputParser.csproj", "./InputParse/"]
COPY ["FrameGenerator/FrameGenerator.csproj", "./FrameGenerator/"]
RUN dotnet restore "DCSSTV/DCSSTV.Wasm/DCSSTV.Wasm.csproj"